#!/bin/bash

clock_icon="${clock_icon:-\uf017}"

clock_init() {
	while :; do
		echo "time_request" > "$1"
		sleep 1
	done &
}

if [ "$1" == "--init" ]; then
	clock_init "$2"
	exit 0
fi

read -r line
[ "$line" == "time_request" ] || exit 1

TIMESTRING=$(date +"%H:%M")
echo -n -e "icon:${clock_icon} text:\"${TIMESTRING}\""
